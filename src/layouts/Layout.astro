---
import '../styles/global.css';
import siteInfo from '../data/site-info.json';

interface Props {
  titre: string;
  description?: string;
  image?: string;
}

const { titre, description = siteInfo.description, image = '/images/170822080831_gerhyfnudagcr2ptdb4nxsitctuxdn.jpg' } = Astro.props;
const canonicalURL = new URL(Astro.url.pathname, Astro.site);
const siteURL = Astro.site?.toString() || 'https://motocross-chavagnes.fr';
const fullImageURL = new URL(image, siteURL).toString();
---

<!doctype html>
<html lang="fr">
  <head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <meta name="description" content={description} />
    <meta name="keywords" content="motocross, chavagnes, chavagnes-les-eaux, terranjou, maine-et-loire, anjou, ffm, ufolep, circuit motocross, terrain motocross, motocross 49, club motocross" />
    <meta name="generator" content={Astro.generator} />

    <!-- Canonical URL -->
    <link rel="canonical" href={canonicalURL} />

    <!-- Open Graph / Facebook -->
    <meta property="og:type" content="website" />
    <meta property="og:url" content={canonicalURL} />
    <meta property="og:title" content={`${titre} | ${siteInfo.nom}`} />
    <meta property="og:description" content={description} />
    <meta property="og:image" content={fullImageURL} />
    <meta property="og:locale" content="fr_FR" />
    <meta property="og:site_name" content={siteInfo.nom} />

    <!-- Twitter -->
    <meta name="twitter:card" content="summary_large_image" />
    <meta name="twitter:url" content={canonicalURL} />
    <meta name="twitter:title" content={`${titre} | ${siteInfo.nom}`} />
    <meta name="twitter:description" content={description} />
    <meta name="twitter:image" content={fullImageURL} />

    <!-- Schema.org pour le référencement local -->
    <script type="application/ld+json" is:inline>
      {
        "@context": "https://schema.org",
        "@type": "SportsActivityLocation",
        "name": "ACSM Chavagnes-les-Eaux",
        "description": "Terrain de motocross à Terranjou (Maine-et-Loire, Anjou). Circuit homologué FFM et UFOLEP",
        "url": "https://motocross-chavagnes.fr",
        "address": {
          "@type": "PostalAddress",
          "streetAddress": "Terrain de planche mallet",
          "addressLocality": "Terranjou",
          "postalCode": "49380",
          "addressRegion": "Maine-et-Loire",
          "addressCountry": "FR"
        },
        "openingHoursSpecification": [
          {
            "@type": "OpeningHoursSpecification",
            "dayOfWeek": ["Saturday", "Sunday"],
            "opens": "09:00",
            "closes": "18:00",
            "description": "Ouvert les 1er et 3ème week-end de chaque mois"
          }
        ],
        "sport": "Motocross",
        "email": "contact@acsm-chavagnes.fr"
      }
    </script>

    <!-- Favicon -->
    <link rel="icon" type="image/svg+xml" href="/favicon.ico" />

    <!-- Google Fonts -->
    <link rel="preconnect" href="https://fonts.googleapis.com" />
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin />
    <link href="https://fonts.googleapis.com/css2?family=Inter:wght@400;500;600;700;800&family=Montserrat:wght@400;500;600;700;800;900&display=swap" rel="stylesheet" />

    <!-- Netlify Identity Widget -->
    <script src="https://identity.netlify.com/v1/netlify-identity-widget.js"></script>

    <title>{titre} | {siteInfo.nom}</title>
  </head>
  <body>
    <header>
      <nav class="navbar">
        <div class="container">
          <div class="nav-wrapper">
            <a href="/" class="logo">
              <img src="/images/logo_acsm.svg" alt={siteInfo.nom} class="logo-image" loading="eager" />
            </a>
            <ul class="nav-menu">
              <li class="mobile-logo">
                <a href="/">
                  <img src="/images/logo_acsm.svg" alt={siteInfo.nom} loading="eager" />
                </a>
              </li>
              <li><a href="/">Accueil</a></li>

              <!-- Menu déroulant Présentation -->
              <li class="dropdown">
                <button class="dropdown-toggle" aria-expanded="false" aria-haspopup="true">
                  Présentation
                  <svg class="dropdown-arrow" xmlns="http://www.w3.org/2000/svg" width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round">
                    <polyline points="6 9 12 15 18 9"></polyline>
                  </svg>
                </button>
                <ul class="dropdown-menu">
                  <li><a href="/presentation">Le terrain</a></li>
                  <li><a href="/presentation#galerie-photo">Galerie</a></li>
                  <li><a href="/presentation#galerie-video">Vidéos</a></li>
                </ul>
              </li>

              <!-- Menu déroulant Informations -->
              <li class="dropdown">
                <button class="dropdown-toggle" aria-expanded="false" aria-haspopup="true">
                  Informations
                  <svg class="dropdown-arrow" xmlns="http://www.w3.org/2000/svg" width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round">
                    <polyline points="6 9 12 15 18 9"></polyline>
                  </svg>
                </button>
                <ul class="dropdown-menu">
                  <li><a href="/reglement">Règlement</a></li>
                  <li><a href="/tarifs">Tarifs roulage</a></li>
                  <li><a href="/horaires">Horaires</a></li>
                </ul>
              </li>

              <!-- Menu déroulant Prise de licence -->
              <li class="dropdown">
                <button class="dropdown-toggle" aria-expanded="false" aria-haspopup="true">
                  Prise de licence
                  <svg class="dropdown-arrow" xmlns="http://www.w3.org/2000/svg" width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round">
                    <polyline points="6 9 12 15 18 9"></polyline>
                  </svg>
                </button>
                <ul class="dropdown-menu">
                  <li><a href="/tarifs#tarifs-ffm">Tarifs FFM</a></li>
                  <li><a href="/tarifs#tarifs-ufolep">Tarifs UFOLEP</a></li>
                </ul>
              </li>

              <li><a href="/faq">FAQ</a></li>
              <li><a href="/contact" class="btn-nav">Contact</a></li>
              <li class="mobile-credit">
                <p>Réalisé par <a href="https://syntexs.com" target="_blank" rel="noopener">Syntexs</a></p>
              </li>
            </ul>
            <button class="mobile-menu-toggle" aria-label="Menu">
              <span></span>
              <span></span>
              <span></span>
            </button>
          </div>
        </div>
      </nav>
    </header>

    <main>
      <slot />
    </main>

    <footer>
      <div class="container">
        <!-- Logo aligné à gauche -->
        <div class="footer-logo-section">
          <a href="/" class="footer-logo">
            <img src="/images/logo_acsm.svg" alt={siteInfo.nom} loading="lazy" />
          </a>
        </div>

        <!-- Réseaux sociaux avec labels -->
        {(siteInfo.social?.facebook || siteInfo.social?.instagram || siteInfo.social?.tiktok) && (
          <div class="social-links">
            {siteInfo.social.instagram && (
              <a href={siteInfo.social.instagram} target="_blank" rel="noopener" class="social-item">
                <span class="social-icon">
                  <svg xmlns="http://www.w3.org/2000/svg" width="20" height="20" viewBox="0 0 24 24" fill="currentColor">
                    <path d="M12 2.163c3.204 0 3.584.012 4.85.07 3.252.148 4.771 1.691 4.919 4.919.058 1.265.069 1.645.069 4.849 0 3.205-.012 3.584-.069 4.849-.149 3.225-1.664 4.771-4.919 4.919-1.266.058-1.644.07-4.85.07-3.204 0-3.584-.012-4.849-.07-3.26-.149-4.771-1.699-4.919-4.92-.058-1.265-.07-1.644-.07-4.849 0-3.204.013-3.583.07-4.849.149-3.227 1.664-4.771 4.919-4.919 1.266-.057 1.645-.069 4.849-.069zm0-2.163c-3.259 0-3.667.014-4.947.072-4.358.2-6.78 2.618-6.98 6.98-.059 1.281-.073 1.689-.073 4.948 0 3.259.014 3.668.072 4.948.2 4.358 2.618 6.78 6.98 6.98 1.281.058 1.689.072 4.948.072 3.259 0 3.668-.014 4.948-.072 4.354-.2 6.782-2.618 6.979-6.98.059-1.28.073-1.689.073-4.948 0-3.259-.014-3.667-.072-4.947-.196-4.354-2.617-6.78-6.979-6.98-1.281-.059-1.69-.073-4.949-.073zm0 5.838c-3.403 0-6.162 2.759-6.162 6.162s2.759 6.163 6.162 6.163 6.162-2.759 6.162-6.163c0-3.403-2.759-6.162-6.162-6.162zm0 10.162c-2.209 0-4-1.79-4-4 0-2.209 1.791-4 4-4s4 1.791 4 4c0 2.21-1.791 4-4 4zm6.406-11.845c-.796 0-1.441.645-1.441 1.44s.645 1.44 1.441 1.44c.795 0 1.439-.645 1.439-1.44s-.644-1.44-1.439-1.44z"/>
                  </svg>
                </span>
                <span class="social-label">INSTAGRAM</span>
              </a>
            )}
            {siteInfo.social.facebook && (
              <a href={siteInfo.social.facebook} target="_blank" rel="noopener" class="social-item">
                <span class="social-icon">
                  <svg xmlns="http://www.w3.org/2000/svg" width="20" height="20" viewBox="0 0 24 24" fill="currentColor">
                    <path d="M24 12.073c0-6.627-5.373-12-12-12s-12 5.373-12 12c0 5.99 4.388 10.954 10.125 11.854v-8.385H7.078v-3.47h3.047V9.43c0-3.007 1.792-4.669 4.533-4.669 1.312 0 2.686.235 2.686.235v2.953H15.83c-1.491 0-1.956.925-1.956 1.874v2.25h3.328l-.532 3.47h-2.796v8.385C19.612 23.027 24 18.062 24 12.073z"/>
                  </svg>
                </span>
                <span class="social-label">FACEBOOK</span>
              </a>
            )}
            {siteInfo.social.tiktok && (
              <a href={siteInfo.social.tiktok} target="_blank" rel="noopener" class="social-item">
                <span class="social-icon">
                  <svg xmlns="http://www.w3.org/2000/svg" width="20" height="20" viewBox="0 0 24 24" fill="currentColor">
                    <path d="M19.59 6.69a4.83 4.83 0 0 1-3.77-4.25V2h-3.45v13.67a2.89 2.89 0 0 1-5.2 1.74 2.89 2.89 0 0 1 2.31-4.64 2.93 2.93 0 0 1 .88.13V9.4a6.84 6.84 0 0 0-1-.05A6.33 6.33 0 0 0 5 20.1a6.34 6.34 0 0 0 10.86-4.43v-7a8.16 8.16 0 0 0 4.77 1.52v-3.4a4.85 4.85 0 0 1-1-.1z"/>
                  </svg>
                </span>
                <span class="social-label">TIKTOK</span>
              </a>
            )}
          </div>
        )}

        <!-- Footer bottom avec copyright centré -->
        <div class="footer-bottom">
          <p class="copyright">Réalisé par <a href="https://syntexs.com" target="_blank" rel="noopener" class="credit-link">Syntexs</a></p>
        </div>
      </div>
    </footer>

    <style>
      /* Header & Navigation */
      header {
        position: fixed;
        top: 0;
        left: 0;
        right: 0;
        z-index: 100;
        background: var(--header-bg);
        backdrop-filter: none;
        border-bottom: 1px solid var(--header-border);
        box-shadow: var(--header-shadow);
        transition: all var(--transition-normal);
      }

      header.scrolled {
        background: rgba(10, 10, 10, 0.95);
        backdrop-filter: blur(20px);
        border-bottom: 1px solid rgba(255, 184, 0, 0.1);
        box-shadow: 0 4px 20px rgba(0, 0, 0, 0.3);
      }

      .navbar {
        padding: 1rem 0;
      }

      .nav-wrapper {
        display: flex;
        justify-content: space-between;
        align-items: center;
      }

      .logo {
        display: flex;
        align-items: center;
        text-decoration: none;
      }

      .logo-image {
        height: 70px;
        width: auto;
        transition: all var(--transition-fast);
      }

      .logo:hover .logo-image {
        filter: drop-shadow(0 0 15px var(--glow-primary));
        transform: scale(1.05);
      }

      .nav-menu {
        display: flex;
        list-style: none;
        gap: 2rem;
        align-items: center;
      }

      .nav-menu a {
        color: white;
        font-weight: 500;
        font-size: 0.9rem;
        transition: all var(--transition-fast);
        position: relative;
        text-shadow: 0 2px 4px rgba(0, 0, 0, 0.5);
      }

      .nav-menu a:not(.btn-nav):hover {
        color: var(--color-primary);
      }

      .nav-menu a:not(.btn-nav)::after {
        content: '';
        position: absolute;
        bottom: -4px;
        left: 0;
        width: 0;
        height: 2px;
        background: var(--color-primary);
        transition: width var(--transition-normal);
      }

      .nav-menu a:not(.btn-nav):hover::after {
        width: 100%;
      }

      .btn-nav {
        padding: 0.6rem 1.5rem;
        background: var(--color-primary);
        border-radius: 6px;
        color: white !important;
        font-size: 0.9rem;
        font-weight: 700;
        letter-spacing: 0.05em;
        text-shadow: none;
        border: 2px solid var(--color-primary);
      }

      .btn-nav:hover {
        background: transparent;
        transform: translateY(-1px);
        box-shadow: 0 6px 20px var(--shadow-primary-strong);
        color: white !important;
        border-color: var(--color-primary);
      }

      .mobile-menu-toggle {
        display: none;
        flex-direction: column;
        gap: 4px;
        background: none;
        border: none;
        cursor: pointer;
        padding: var(--spacing-xs);
      }

      .mobile-menu-toggle span {
        width: 25px;
        height: 3px;
        background: var(--color-text);
        border-radius: 2px;
        transition: all var(--transition-fast);
      }

      .mobile-logo {
        display: none;
      }

      .mobile-credit {
        display: none;
      }

      /* Dropdown styles */
      .dropdown {
        position: relative;
      }

      .dropdown-toggle {
        display: flex;
        align-items: center;
        gap: 4px;
        background: none;
        border: none;
        color: white;
        font-weight: 500;
        font-size: 0.9rem;
        cursor: pointer;
        padding: 0;
        transition: all var(--transition-fast);
        position: relative;
        text-shadow: 0 2px 4px rgba(0, 0, 0, 0.5);
        font-family: var(--font-body);
      }

      .dropdown-toggle:hover {
        color: var(--color-primary);
      }

      .dropdown-toggle::after {
        content: '';
        position: absolute;
        bottom: -4px;
        left: 0;
        width: 0;
        height: 2px;
        background: var(--color-primary);
        transition: width var(--transition-normal);
      }

      .dropdown-toggle:hover::after {
        width: 100%;
      }

      .dropdown-arrow {
        transition: transform var(--transition-fast);
      }

      .dropdown.active .dropdown-arrow {
        transform: rotate(180deg);
      }

      .dropdown-menu {
        position: absolute;
        top: calc(100% + 10px);
        left: 0;
        min-width: 180px;
        background: var(--color-dark);
        border: 1px solid var(--color-border);
        border-radius: var(--radius-md);
        list-style: none;
        opacity: 0;
        visibility: hidden;
        transform: translateY(-10px);
        transition: all var(--transition-fast);
        box-shadow: 0 8px 24px rgba(0, 0, 0, 0.5);
        z-index: 100;
        margin-top: 10px;
      }

      .dropdown:hover .dropdown-menu,
      .dropdown.active .dropdown-menu {
        opacity: 1;
        visibility: visible;
        transform: translateY(0);
      }

      .dropdown-menu li {
        width: 100%;
      }

      .dropdown-menu a {
        display: block;
        padding: var(--spacing-sm) var(--spacing-md);
        color: var(--color-text-secondary);
        font-size: 0.9rem;
        transition: all var(--transition-fast);
        text-shadow: none;
      }

      .dropdown-menu a:hover {
        background: rgba(185, 28, 28, 0.1);
        color: var(--color-primary);
        padding-left: calc(var(--spacing-md) + 8px);
      }

      .dropdown-menu a::after {
        display: none;
      }

      /* Footer Minimaliste - Style identique à l'image */
      footer {
        background: var(--color-dark);
        margin-top: 0;
        padding: var(--spacing-2xl) 0 var(--spacing-lg);
      }

      /* Logo Section */
      .footer-logo-section {
        text-align: center;
        margin-bottom: var(--spacing-xl);
      }

      .footer-logo {
        display: inline-block;
      }

      .footer-logo img {
        height: 100px;
        width: auto;
        transition: all var(--transition-fast);
      }

      .footer-logo:hover img {
        filter: drop-shadow(0 0 15px var(--color-primary));
        transform: scale(1.05);
      }

      /* Social Links */
      .social-links {
        display: flex;
        justify-content: center;
        align-items: center;
        gap: var(--spacing-xl);
        margin-bottom: var(--spacing-xl);
        flex-wrap: wrap;
      }

      .social-item {
        display: flex;
        align-items: center;
        gap: var(--spacing-sm);
        color: white;
        text-decoration: none;
        transition: all var(--transition-fast);
      }

      .social-item:hover {
        color: var(--color-primary);
      }

      .social-icon {
        display: flex;
        align-items: center;
        justify-content: center;
        width: 40px;
        height: 40px;
        border-radius: 50%;
        background: white;
        color: var(--color-dark);
        transition: all var(--transition-fast);
      }

      .social-item:hover .social-icon {
        background: var(--color-primary);
        color: white;
      }

      .social-label {
        font-weight: 700;
        font-size: 0.85rem;
        letter-spacing: 0.1em;
        text-transform: uppercase;
      }

      /* Footer Bottom */
      .footer-bottom {
        border-top: 1px solid rgba(255, 255, 255, 0.1);
        padding-top: var(--spacing-lg);
        text-align: center;
      }

      .copyright {
        color: var(--color-text-secondary);
        font-size: 0.85rem;
        margin: 0;
      }

      .credit-link {
        color: white;
        font-weight: 600;
        transition: color var(--transition-fast);
      }

      .credit-link:hover {
        color: var(--color-primary);
      }

      /* Mobile */
      @media (max-width: 768px) {
        .nav-menu {
          position: fixed;
          top: 0;
          right: -100%;
          width: 100%;
          height: 100vh;
          background: var(--color-dark);
          flex-direction: column;
          gap: 0;
          padding: 6rem 2rem 2rem;
          transition: right 0.3s ease;
          box-shadow: -5px 0 15px rgba(0, 0, 0, 0.3);
          z-index: 99;
          overflow-y: auto;
        }

        .nav-menu.active {
          right: 0;
        }

        .nav-menu > li {
          width: 100%;
        }

        .nav-menu > li:not(.mobile-logo):not(.mobile-credit):not(.dropdown) {
          border-bottom: 1px solid rgba(255, 255, 255, 0.1);
        }

        .nav-menu > li > a {
          display: block;
          padding: 1rem 0;
          font-size: 1rem;
        }

        .nav-menu a:not(.btn-nav)::after {
          display: none;
        }

        /* Dropdown mobile styles */
        .dropdown {
          border-bottom: 1px solid rgba(255, 255, 255, 0.1);
        }

        .dropdown-toggle {
          width: 100%;
          padding: 1rem 0;
          font-size: 1rem;
          justify-content: space-between;
          text-align: left;
        }

        .dropdown-toggle::after {
          display: none;
        }

        .dropdown-menu {
          position: static;
          opacity: 1;
          visibility: visible;
          transform: none;
          background: rgba(185, 28, 28, 0.05);
          border: none;
          border-radius: 0;
          box-shadow: none;
          max-height: 0;
          overflow: hidden;
          transition: max-height var(--transition-normal) ease;
          padding: 0;
        }

        .dropdown.active .dropdown-menu {
          max-height: 300px;
          padding: var(--spacing-sm) 0;
        }

        .dropdown-menu li {
          border-bottom: none;
        }

        .dropdown-menu a {
          padding: var(--spacing-sm) var(--spacing-lg);
          font-size: 0.95rem;
        }

        .dropdown-menu a:hover {
          padding-left: var(--spacing-lg);
        }

        .btn-nav {
          margin-top: 1rem;
          text-align: center;
          display: block;
          font-size: 0.8rem !important;
          padding: 0.7rem 1.2rem !important;
        }

        .mobile-menu-toggle {
          display: flex;
          z-index: 101;
        }

        .mobile-menu-toggle.active span:nth-child(1) {
          transform: rotate(45deg) translate(5px, 5px);
        }

        .mobile-menu-toggle.active span:nth-child(2) {
          opacity: 0;
        }

        .mobile-menu-toggle.active span:nth-child(3) {
          transform: rotate(-45deg) translate(7px, -6px);
        }

        .mobile-logo {
          display: block;
          text-align: center;
          padding: 0 0 var(--spacing-lg) 0;
          margin-bottom: var(--spacing-lg);
        }

        .mobile-logo a {
          display: inline-block;
          padding: 0;
        }

        .mobile-logo img {
          height: 80px;
          width: auto;
        }

        .mobile-credit {
          display: block;
          margin-top: auto;
          padding-top: var(--spacing-xl);
        }

        .mobile-credit p {
          color: var(--color-text-secondary);
          font-size: 0.85rem;
          text-align: center;
          margin: 0;
          padding: var(--spacing-md) 0;
        }

        .mobile-credit a {
          color: white !important;
          font-weight: 600;
          padding: 0 !important;
          border: none !important;
          background: none !important;
          transition: color var(--transition-fast) !important;
        }

        .mobile-credit a:hover {
          color: var(--color-primary) !important;
          transform: none !important;
          box-shadow: none !important;
        }

        .social-links {
          gap: var(--spacing-md);
        }

        .social-label {
          display: none;
        }

        .social-icon {
          width: 44px;
          height: 44px;
        }

        .footer-bottom-content {
          flex-direction: column;
          text-align: center;
        }

        .footer-contact {
          justify-content: center;
        }
      }
    </style>

    <script>
      // Mobile menu toggle
      const menuToggle = document.querySelector('.mobile-menu-toggle');
      const navMenu = document.querySelector('.nav-menu');

      menuToggle?.addEventListener('click', () => {
        navMenu?.classList.toggle('active');
        menuToggle?.classList.toggle('active');
      });

      // Dropdown toggle for mobile
      const dropdownToggles = document.querySelectorAll('.dropdown-toggle');
      dropdownToggles.forEach(toggle => {
        toggle.addEventListener('click', (e) => {
          // On mobile, toggle the dropdown
          if (window.innerWidth <= 768) {
            e.preventDefault();
            const dropdown = toggle.closest('.dropdown');
            const isActive = dropdown?.classList.contains('active');

            // Close all other dropdowns
            document.querySelectorAll('.dropdown').forEach(d => {
              if (d !== dropdown) {
                d.classList.remove('active');
                d.querySelector('.dropdown-toggle')?.setAttribute('aria-expanded', 'false');
              }
            });

            // Toggle current dropdown
            dropdown?.classList.toggle('active');
            toggle.setAttribute('aria-expanded', !isActive ? 'true' : 'false');
          }
        });
      });

      // Close menu when clicking on a dropdown link
      const dropdownLinks = document.querySelectorAll('.dropdown-menu a');
      dropdownLinks.forEach(link => {
        link.addEventListener('click', () => {
          navMenu?.classList.remove('active');
          menuToggle?.classList.remove('active');
          // Close all dropdowns
          document.querySelectorAll('.dropdown').forEach(d => {
            d.classList.remove('active');
            d.querySelector('.dropdown-toggle')?.setAttribute('aria-expanded', 'false');
          });
        });
      });

      // Close menu when clicking on regular nav links
      const navLinks = document.querySelectorAll('.nav-menu > li > a:not(.btn-nav)');
      navLinks.forEach(link => {
        link.addEventListener('click', () => {
          navMenu?.classList.remove('active');
          menuToggle?.classList.remove('active');
        });
      });

      // Header scroll effect
      const header = document.querySelector('header');

      window.addEventListener('scroll', () => {
        if (window.scrollY > 50) {
          header?.classList.add('scrolled');
        } else {
          header?.classList.remove('scrolled');
        }
      });

      // Netlify Identity - Handle invite tokens and authentication
      if ((window as any).netlifyIdentity) {
        const netlifyIdentity = (window as any).netlifyIdentity;
        
        netlifyIdentity.on("init", (user: any) => {
          if (!user) {
            // Redirect to /admin after login
            netlifyIdentity.on("login", () => {
              document.location.href = "/admin/";
            });
          }
        });

        // Handle signup completion (after accepting invite)
        netlifyIdentity.on("signup", () => {
          document.location.href = "/admin/";
        });

        // Handle close event to redirect if on admin page
        netlifyIdentity.on("close", () => {
          const currentUser = netlifyIdentity.currentUser();
          if (currentUser && window.location.pathname === "/") {
            document.location.href = "/admin/";
          }
        });
      }
    </script>
  </body>
</html>
