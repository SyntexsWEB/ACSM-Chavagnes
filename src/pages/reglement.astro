---
import Layout from '../layouts/Layout.astro';
import HeroPage from '../components/HeroPage.astro';
import RegleCard from '../components/RegleCard.astro';
import { getEntry } from 'astro:content';
import siteInfo from '../data/site-info.json';

const page = await getEntry('pages', 'reglement');
if (!page) throw new Error('Page not found: reglement');
const { Content } = await page.render();

const heroData = page.data.hero || {
  image: '/images/motocross-saut-1.jpg',
  titre: 'Règlement du terrain',
  soustitre: 'Les règles à respecter pour votre sécurité'
};
---

<Layout
  titre={page.data.titre}
  description={page.data.description}
>
  <HeroPage
    titre={heroData.titre ?? 'Règlement du terrain'}
    soustitre={heroData.soustitre ?? 'Les règles à respecter pour votre sécurité'}
    image={heroData.image ?? '/images/motocross-saut-1.jpg'}
  />

  <section class="section reglement-section">
    <div class="container">

      <!-- Introduction -->
      <div class="reglement-intro">
        <h2>Règles essentielles de sécurité</h2>
        <p>Pour garantir la sécurité de tous, merci de respecter scrupuleusement le règlement suivant :</p>
      </div>

      <!-- Règles principales avec icônes -->
      <div class="regles-grid">
        <RegleCard
          icone='<svg xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" stroke="currentColor"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M9 12h6m-6 4h6m2 5H7a2 2 0 01-2-2V5a2 2 0 012-2h5.586a1 1 0 01.707.293l5.414 5.414a1 1 0 01.293.707V19a2 2 0 01-2 2z" /></svg>'
          titre="Inscription obligatoire"
          description="Tout pilote doit s'inscrire à l'accueil avant de rouler. Présentation de la licence FFM ou UFOLEP obligatoire. Les visiteurs non-licenciés doivent rester en zone publique."
        />

        <RegleCard
          icone='<svg xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" stroke="currentColor"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M9 12l2 2 4-4m5.618-4.016A11.955 11.955 0 0112 2.944a11.955 11.955 0 01-8.618 3.04A12.02 12.02 0 003 9c0 5.591 3.824 10.29 9 11.622 5.176-1.332 9-6.03 9-11.622 0-1.042-.133-2.052-.382-3.016z" /></svg>'
          titre="Équipement de protection"
          description="Port obligatoire du casque homologué, gants, bottes, pantalon et maillot de protection. Les protections dorsales et plastrons sont fortement recommandés."
        />

        <RegleCard
          icone='<svg xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" stroke="currentColor"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M12 9v2m0 4h.01m-6.938 4h13.856c1.54 0 2.502-1.667 1.732-3L13.732 4c-.77-1.333-2.694-1.333-3.464 0L3.34 16c-.77 1.333.192 3 1.732 3z" /></svg>'
          titre="Respect des autres pilotes"
          description="Adaptez votre vitesse en fonction de votre niveau et de celui des autres. Ne doublez que si vous êtes sûr de ne pas gêner. Priorité aux pilotes plus rapides."
          important={true}
        />

        <RegleCard
          icone='<svg xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" stroke="currentColor"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M19 21V5a2 2 0 00-2-2H7a2 2 0 00-2 2v16m14 0h2m-2 0h-5m-9 0H3m2 0h5M9 7h1m-1 4h1m4-4h1m-1 4h1m-5 10v-5a1 1 0 011-1h2a1 1 0 011 1v5m-4 0h4" /></svg>'
          titre="Tapis environnemental obligatoire"
          description="Le tapis environnemental est obligatoire pour tous les véhicules afin de protéger l'environnement. Aucune fuite d'huile ou de carburant n'est tolérée sur le terrain."
        />

        <RegleCard
          icone='<svg xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" stroke="currentColor"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M17.657 18.657A8 8 0 016.343 7.343S7 9 9 10c0-2 .5-5 2.986-7C14 5 16.09 5.777 17.656 7.343A7.975 7.975 0 0120 13a7.975 7.975 0 01-2.343 5.657z" /><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M9.879 16.121A3 3 0 1012.015 11L11 14H9c0 .768.293 1.536.879 2.121z" /></svg>'
          titre="Sécurité incendie"
          description="Interdiction formelle de faire du feu. Respectez les zones de ravitaillement. Un extincteur doit être à disposition dans chaque paddock."
          important={true}
        />

        <RegleCard
          icone='<svg xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" stroke="currentColor"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M17 20h5v-2a3 3 0 00-5.356-1.857M17 20H7m10 0v-2c0-.656-.126-1.283-.356-1.857M7 20H2v-2a3 3 0 015.356-1.857M7 20v-2c0-.656.126-1.283.356-1.857m0 0a5.002 5.002 0 019.288 0M15 7a3 3 0 11-6 0 3 3 0 016 0zm6 3a2 2 0 11-4 0 2 2 0 014 0zM7 10a2 2 0 11-4 0 2 2 0 014 0z" /></svg>'
          titre="Mineurs accompagnés"
          description="Les mineurs doivent obligatoirement être accompagnés d'un adulte responsable présent sur le site durant toute la session. Sessions spécifiques organisées pour les moins de 12 ans."
        />
      </div>

      <!-- Règlement complet en texte -->
      <div class="reglement-details">
        <div class="details-header">
          <h2>Règlement complet 2026</h2>
          <div class="header-underline"></div>
        </div>
        <div class="reglement-content markdown-content">
          <Content />
        </div>
      </div>

      <div class="cta-section">
        <a href="/faq" class="btn">Consulter la FAQ</a>
        <a href="/contact" class="btn btn-secondary">Nous contacter</a>
      </div>
    </div>
  </section>
</Layout>

<style>
  .reglement-section {
    background: var(--color-dark);
  }

  .reglement-intro {
    text-align: center;
    max-width: 800px;
    margin: 0 auto var(--spacing-2xl);
  }

  .reglement-intro h2 {
    font-size: clamp(1.75rem, 4vw, 2.5rem);
    color: var(--color-text);
    margin-bottom: var(--spacing-md);
    font-weight: 700;
  }

  .reglement-intro p {
    font-size: 1.1rem;
    color: var(--color-text-secondary);
    line-height: 1.7;
  }

  .regles-grid {
    display: grid;
    grid-template-columns: repeat(auto-fit, minmax(320px, 1fr));
    gap: var(--spacing-lg);
    margin-bottom: var(--spacing-2xl);
  }

  .reglement-details {
    background: var(--color-dark-lighter);
    border-radius: var(--radius-lg);
    padding: var(--spacing-2xl);
    margin-bottom: var(--spacing-2xl);
    border: 1px solid var(--color-border);
  }

  .details-header {
    text-align: center;
    margin-bottom: var(--spacing-xl);
  }

  .details-header h2 {
    font-size: clamp(1.75rem, 4vw, 2.25rem);
    color: var(--color-text);
    margin-bottom: var(--spacing-md);
    font-weight: 700;
  }

  .header-underline {
    width: 60px;
    height: 4px;
    background: var(--color-primary);
    margin: 0 auto;
    border-radius: 2px;
  }

  .reglement-content {
    max-width: 900px;
    margin: 0 auto;
  }

  .markdown-content :global(h2) {
    color: var(--color-primary);
    margin-bottom: var(--spacing-md);
    margin-top: var(--spacing-xl);
    font-size: 1.75rem;
    font-weight: 700;
  }

  .markdown-content :global(h3) {
    color: var(--color-primary-light);
    margin-top: var(--spacing-lg);
    margin-bottom: var(--spacing-md);
    font-size: 1.25rem;
    font-weight: 600;
  }

  .markdown-content :global(p) {
    line-height: 1.8;
    margin-bottom: var(--spacing-md);
    color: var(--color-text-secondary);
    word-wrap: break-word;
    overflow-wrap: break-word;
  }

  .markdown-content :global(ul),
  .markdown-content :global(ol) {
    margin: var(--spacing-md) 0;
    padding-left: 0;
    list-style: none;
  }

  .markdown-content :global(li) {
    padding: var(--spacing-xs) 0 var(--spacing-xs) var(--spacing-lg);
    color: var(--color-text-secondary);
    position: relative;
    line-height: 1.6;
  }

  .markdown-content :global(li::before) {
    content: '▸';
    position: absolute;
    left: 0;
    color: var(--color-primary);
    font-weight: bold;
  }

  .markdown-content :global(ul ul) {
    margin-top: var(--spacing-xs);
    margin-left: var(--spacing-md);
  }

  .markdown-content :global(strong) {
    color: var(--color-text);
    word-wrap: break-word;
    overflow-wrap: break-word;
  }

  .markdown-content :global(em) {
    color: var(--color-text-secondary);
    font-size: 0.9rem;
  }

  .markdown-content :global(a) {
    color: var(--color-primary);
    text-decoration: underline;
  }

  .markdown-content :global(a:hover) {
    color: var(--color-primary-light);
  }

  .cta-section {
    display: flex;
    gap: var(--spacing-md);
    justify-content: center;
    margin-top: var(--spacing-2xl);
    flex-wrap: wrap;
  }

  @media (max-width: 768px) {
    .reglement-details {
      padding-left: var(--spacing-md);
      padding-right: var(--spacing-md);
    }

    .cta-section {
      flex-direction: column;
    }

    .cta-section .btn {
      width: 100%;
      text-align: center;
    }
  }
</style>
